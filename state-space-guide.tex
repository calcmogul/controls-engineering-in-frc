\documentclass[11pt]{book}

\usepackage{amsmath,amssymb,amsthm}
\DeclareMathOperator{\eig}{eig}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\sinc}{sinc}
\DeclareMathOperator{\tr}{tr}
\usepackage[english]{babel} % English language/hyphenation
\usepackage{bm}
\usepackage{booktabs} % For nicer horizontal rules in tables
\usepackage{calc} % For simpler calculation in spacing index letter headings
\usepackage{colortbl} % For colored table rows
\usepackage{csquotes} % Suppress warning from babel about missing csquotes
\usepackage{datetime} % For the generated date
\usepackage{fancyhdr} % For the headers
\usepackage{float} % For preventing figure floating
\usepackage[bottom]{footmisc} % For putting footnotes at the bottom of the page
\usepackage{textcomp,gensymb} % For degree symbol
\usepackage[top=3cm,bottom=3cm,left=3cm,right=3cm,headsep=10pt,a4paper]{geometry}
\usepackage{graphicx} % For including figures
\graphicspath{{build/figs/}} % Specifies directory where figures are stored
\usepackage{imakeidx} % For \indexsetup command to fix index heading style
\usepackage{listings}
\usepackage{mathrsfs}
\usepackage{mathtools} % For \prescript{}
\DeclareMathAlphabet{\mathscrbf}{OMS}{cmsy}{m}{n}
\usepackage{makeidx}
\usepackage{parskip}
\usepackage{placeins} % For FloatBarrier command
\usepackage{subcaption}
\usepackage{tabulary}
\usepackage{tikz}
\usepackage{titletoc}

\usepackage{enumitem} % Customize lists
\setlist{nolistsep} % Reduce spacing between bullet points and numbered lists

% Font setup
\usepackage{microtype} % Slightly tweak font spacing for aesthetics
\usepackage[T1]{fontenc} % Use 8-bit encoding that has 256 glyphs

% Set main fonts
\usepackage[no-math]{fontspec}
\setmainfont[Path=./fonts/,
             BoldFont=FreeSerifBold.ttf,
             ItalicFont=FreeSerifItalic.ttf,
             BoldItalicFont=FreeSerifBoldItalic.ttf]{FreeSerif.ttf}
\setsansfont[Path=./fonts/,
             BoldFont=FreeSansBold.ttf,
             ItalicFont=FreeSansOblique.ttf,
             BoldItalicFont=FreeSansBoldOblique.ttf]{FreeSans.ttf}
\renewcommand{\familydefault}{\rmdefault}

% Bibliography setup
\usepackage[style=numeric,citestyle=numeric,sorting=nyt,sortcites=true,autopunct=true,autolang=hyphen,hyperref=true,abbreviate=false,backref=true,backend=biber]{biblatex}
\addbibresource{state-space-guide.bib}
\defbibheading{bibempty}{}

% Index setup
\makeindex
\indexsetup{othercode={\fancyhead[LO,RE]{\sffamily\bfseries Index}}}

\usepackage{hyperref}
\hypersetup{hidelinks,colorlinks=false,breaklinks=true,bookmarksopen=false,
  pdftitle={Practical Guide to State-space Control},pdfauthor={Tyler Veness}}

% Load after hyperref
\usepackage[nopostdot,style=index,nonumberlist]{glossaries}

\input{preamble/styles}
\input{preamble/macros}
\input{preamble/config}
\input{preamble/layout}

\renewcommand*{\glstextformat}[1]{\textcolor{glscolor}{#1}}
\input{glossary-entries}
\makeglossaries

\begin{document}
% \usechapterimagefalse
\frontmatter
\input{frontmatter/cover}
\input{frontmatter/title}
\input{frontmatter/copyright}
\input{frontmatter/toc}
\input{frontmatter/preface}

% Define path commands for redefinition later
\newcommand*{\partpath}{}
\newcommand*{\chapterpath}{}

\mainmatter
\setcounter{chapter}{-1}

\renewcommand*{\partpath}{introduction}
\input{\partpath/notes-to-the-reader}
\input{\partpath/introduction-to-control-theory}

\part{Kinematics and dynamics}
\renewcommand*{\partpath}{kinematics-and-dynamics}
\input{\partpath/calculus}
\input{\partpath/dynamics}
\input{\partpath/model-examples}

\part{Classical control theory}
\renewcommand*{\partpath}{classical-control-theory}
\input{\partpath/control-system-basics}
\input{\partpath/pid-controllers}
\input{\partpath/laplace-domain-analysis}

\part{Modern control theory}
\renewcommand*{\partpath}{modern-control-theory}
\input{\partpath/linear-algebra}
\input{\partpath/ss-controllers}
\input{\partpath/digital-control}
\input{\partpath/ss-model-examples}
\input{\partpath/nonlinear-control}

\part{Estimation and localization}
\renewcommand*{\partpath}{estimation-and-localization}
\input{\partpath/ss-observers}
\input{\partpath/stochastic-control-theory}

\part{Motion planning}
\renewcommand*{\partpath}{motion-planning}
\input{\partpath/motion-profiles}

\part{Appendices}
\renewcommand{\chaptermark}[1]{\markboth{\sffamily\normalsize\bfseries\appendixname\ \thechapter.\ #1}{}}
\appendix
\renewcommand*{\partpath}{appendices}
\input{\partpath/simplifying-block-diagrams}
\input{\partpath/installing-python-packages}
\input{\partpath/ss-canonical-forms}
\input{\partpath/derivations}

\renewcommand{\chaptermark}[1]{\markboth{\sffamily\normalsize\bfseries #1}{}}
\backmatter
\chapterimage{backmatter.jpg}{Sunset near Porter Academic building at UCSC}
\input{backmatter/glossary}
\input{backmatter/bibliography}
\input{backmatter/index}
\input{backmatter/cover}
\end{document}
